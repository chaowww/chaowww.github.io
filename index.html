.editor-actions {
display: flex;
gap: 8px;
      flex-wrap: wrap;
}

.editor-btn {
@@ -384,6 +385,11 @@
font-family: inherit;
}

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
    }

/* 模态框 */
.modal {
display: none;
@@ -498,6 +504,63 @@
gap: 12px;
}

    /* 密码设置面板 */
    .setup-panel {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }

    .setup-panel.show {
      display: flex;
    }

    .setup-content {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 40px;
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    .setup-content h3 {
      margin-bottom: 16px;
      color: var(--text);
    }

    .setup-content p {
      color: var(--muted);
      margin-bottom: 24px;
    }

    .setup-input {
      width: 100%;
      padding: 12px;
      margin-bottom: 12px;
      border: 1px solid var(--card-border);
      border-radius: 6px;
      background: rgba(0, 0, 0, 0.2);
      color: var(--text);
      text-align: center;
      font-size: 1rem;
    }

    .setup-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 20px;
    }

/* 响应式调整 */
@media (max-width: 768px) {
body {
@@ -745,6 +808,7 @@ <h3>内容编辑面板</h3>

<div class="editor-actions">
<button class="editor-btn secondary" onclick="saveAllEdits()">保存所有修改</button>
            <button class="editor-btn secondary" onclick="changePassword()">修改密码</button>
<button class="editor-btn danger" onclick="toggleEditMode()">退出编辑模式</button>
</div>
</div>
@@ -774,7 +838,7 @@ <h3 style="margin-bottom: 12px;">实验室信息</h3>
<div class="auth-panel" id="authPanel">
<div class="auth-content">
<h3>编辑模式授权</h3>
      <p>请输入授权密码以开启编辑模式</p>
      <p id="authMessage">请输入授权密码以开启编辑模式</p>
<input type="password" class="auth-input" id="authPassword" placeholder="请输入密码" />
<div class="auth-buttons">
<button class="editor-btn secondary" onclick="closeAuthPanel()">取消</button>
@@ -783,6 +847,20 @@ <h3>编辑模式授权</h3>
</div>
</div>

  <!-- 密码设置面板 -->
  <div class="setup-panel" id="setupPanel">
    <div class="setup-content">
      <h3>首次设置编辑密码</h3>
      <p>这是您第一次使用编辑功能，请设置一个密码用于后续编辑验证。</p>
      <input type="password" class="setup-input" id="setupPassword" placeholder="设置新密码" />
      <input type="password" class="setup-input" id="setupConfirmPassword" placeholder="确认新密码" />
      <div class="setup-buttons">
        <button class="editor-btn secondary" onclick="cancelSetup()">取消</button>
        <button class="editor-btn primary" onclick="setupPassword()">设置密码</button>
      </div>
    </div>
  </div>

<!-- 编辑模态框 -->
<div class="modal" id="editModal">
<div class="modal-content">
@@ -813,7 +891,7 @@ <h3 id="modalTitle">编辑内容</h3>
let editMode = false;
let currentEditingId = null;
let currentEditingType = null;
    let editPassword = "edit123"; // 默认编辑密码
    let editPassword = localStorage.getItem('siteEditPassword') || null;

// 页面切换
function showPage(pageId) {
@@ -829,53 +907,167 @@ <h3 id="modalTitle">编辑内容</h3>
document.querySelectorAll('.nav-btn').forEach(btn => {
btn.classList.remove('active');
});
      event.target.classList.add('active');
      
      // 确保事件对象存在
      if (event && event.target) {
        event.target.classList.add('active');
      } else {
        // 如果没有事件对象，找到对应页面的按钮
        const targetBtn = document.querySelector(`.nav-btn[data-page="${pageId}"]`);
        if (targetBtn) {
          targetBtn.classList.add('active');
        }
      }
}

// 编辑模式切换
function toggleEditMode() {
if (!editMode) {
        // 显示授权面板
        document.getElementById('authPanel').classList.add('show');
        // 检查是否有密码
        if (!editPassword) {
          // 首次使用，显示密码设置面板
          showSetupPanel();
        } else {
          // 已有密码，显示授权面板
          showAuthPanel();
        }
} else {
// 退出编辑模式
exitEditMode();
}
}

    // 显示授权面板
    function showAuthPanel() {
      document.getElementById('authPanel').classList.add('show');
      document.getElementById('authPassword').focus();
    }

    // 关闭授权面板
    function closeAuthPanel() {
      document.getElementById('authPanel').classList.remove('show');
      document.getElementById('authPassword').value = '';
    }

    // 显示密码设置面板
    function showSetupPanel() {
      document.getElementById('setupPanel').classList.add('show');
      document.getElementById('setupPassword').focus();
    }

    // 关闭密码设置面板
    function closeSetupPanel() {
      document.getElementById('setupPanel').classList.remove('show');
      document.getElementById('setupPassword').value = '';
      document.getElementById('setupConfirmPassword').value = '';
    }

    // 取消密码设置
    function cancelSetup() {
      closeSetupPanel();
      // 退出编辑模式
      document.getElementById('editModeBtn').textContent = '开启编辑模式';
    }

    // 设置密码
    function setupPassword() {
      const password = document.getElementById('setupPassword').value;
      const confirmPassword = document.getElementById('setupConfirmPassword').value;
      
      if (!password) {
        alert('密码不能为空！');
        return;
      }
      
      if (password !== confirmPassword) {
        alert('两次输入的密码不一致！');
        return;
      }
      
      if (password.length < 4) {
        alert('密码长度至少为4位！');
        return;
      }
      
      // 保存密码到本地存储
      localStorage.setItem('siteEditPassword', password);
      editPassword = password;
      
      // 关闭设置面板
      closeSetupPanel();
      
      // 直接进入编辑模式
      enterEditMode();
    }

    // 修改密码
    function changePassword() {
      if (!editMode) return;
      
      const oldPassword = prompt('请输入当前密码：');
      if (oldPassword !== editPassword) {
        alert('密码错误！');
        return;
      }
      
      const newPassword = prompt('请输入新密码：');
      const confirmPassword = prompt('请确认新密码：');
      
      if (!newPassword) {
        alert('新密码不能为空！');
        return;
      }
      
      if (newPassword !== confirmPassword) {
        alert('两次输入的密码不一致！');
        return;
      }
      
      if (newPassword.length < 4) {
        alert('密码长度至少为4位！');
        return;
      }
      
      // 更新密码
      localStorage.setItem('siteEditPassword', newPassword);
      editPassword = newPassword;
      alert('密码修改成功！');
    }

// 授权验证
function authenticate() {
const password = document.getElementById('authPassword').value;
if (password === editPassword) {
// 开启编辑模式
        editMode = true;
        document.getElementById('editorPanel').classList.add('show');
        document.getElementById('editModeBtn').textContent = '退出编辑模式';
        
        // 显示编辑控制按钮
        document.querySelectorAll('.edit-controls').forEach(controls => {
          controls.style.display = 'flex';
        });
        
        document.querySelectorAll('.item-actions').forEach(actions => {
          actions.style.display = 'flex';
        });
        
        document.querySelectorAll('.editor-actions').forEach(actions => {
          actions.style.display = 'flex';
        });
        enterEditMode();

// 关闭授权面板
closeAuthPanel();
} else {
alert('密码错误，请重试！');
document.getElementById('authPassword').value = '';
        document.getElementById('authPassword').focus();
}
}

    function closeAuthPanel() {
      document.getElementById('authPanel').classList.remove('show');
      document.getElementById('authPassword').value = '';
    // 进入编辑模式
    function enterEditMode() {
      editMode = true;
      document.getElementById('editorPanel').classList.add('show');
      document.getElementById('editModeBtn').textContent = '退出编辑模式';
      
      // 显示编辑控制按钮
      document.querySelectorAll('.edit-controls').forEach(controls => {
        controls.style.display = 'flex';
      });
      
      document.querySelectorAll('.item-actions').forEach(actions => {
        actions.style.display = 'flex';
      });
      
      document.querySelectorAll('.editor-actions').forEach(actions => {
        actions.style.display = 'flex';
      });
}

// 退出编辑模式
@@ -977,6 +1169,7 @@ <h3 id="modalTitle">编辑内容</h3>
if (!editMode) return;

currentEditingType = 'publication';
      currentEditingId = null;
document.getElementById('modalTitle').textContent = '添加出版物';

// 设置表单字段
@@ -1060,6 +1253,7 @@ <h3 id="modalTitle">编辑内容</h3>
if (!editMode) return;

currentEditingType = 'person';
      currentEditingId = null;
document.getElementById('modalTitle').textContent = '添加团队成员';

// 设置表单字段
@@ -1217,18 +1411,12 @@ <h4>${title}</h4>

// 这里可以添加保存到服务器的逻辑
alert('所有修改已保存！');
      
      // 退出编辑模式
      exitEditMode();
}

// 初始化页面
document.addEventListener('DOMContentLoaded', function() {
// 设置默认页面
showPage('home');
      
      // 设置编辑密码（可以修改）
      editPassword = prompt('请设置编辑密码（默认为edit123）', 'edit123') || 'edit123';
});
</script>
</body>
